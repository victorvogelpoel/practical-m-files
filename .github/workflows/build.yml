name: Build all practical-m-files projects

on:
  workflow_dispatch:
  push:
    paths: ["src/**"]

jobs:
  build:
    timeout-minutes: 15
    runs-on: 'windows-latest'

    steps:
    - uses: actions/checkout@v2

    - name: Setup MSBuild path
      uses: microsoft/setup-msbuild@v1.0.2

    - name: Setup NuGet
      uses: NuGet/setup-nuget@v1.0.5

    - name: Restore NuGet packages
      run: nuget restore src\vaultapplication\vaultapplication-cleanarch\vaultapplication-cleanarch.sln

    - name: Set timezone on Windows to Central Europe Standard Time
      run: tzutil /s "Central Europe Standard Time"

    - name: Build
      run: msbuild src\vaultapplication\vaultapplication-cleanarch\vaultapplication-cleanarch.sln /nologo /verbosity:m /p:Configuration=Release /p:DefineConstants="DONOTDEPLOY"
      run: msbuild src\vaultapplication\vaultapplication-logtomsteams-with-serilog\vaultapplication-logtomsteams-with-serilog.sln" /nologo /verbosity:m /p:Configuration=Release /p:DefineConstants="DONOTDEPLOY"
      run: msbuild src\vaultapplication\vaultapplication-mediatr\vaultapplication-mediatr.sln /nologo /verbosity:m /p:Configuration=Release /p:DefineConstants="DONOTDEPLOY"
      run: msbuild src\vaultapplication\vaultapplication-net48\vaultapplication-net48.sln /nologo /verbosity:m /p:Configuration=Release /p:DefineConstants="DONOTDEPLOY"
      run: msbuild src\vaultapplication\vaultapplication-reporttoeventlog-with-serilog\vaultapplication-reporttoeventlog-with-serilog.sln /nologo /verbosity:m /p:Configuration=Release /p:DefineConstants="DONOTDEPLOY"
      run: msbuild src\vaultapplication\vaultapplication-unittestable-usecase\vaultapplication-unittestable-usecase.sln /nologo /verbosity:m /p:Configuration=Release /p:DefineConstants="DONOTDEPLOY"
